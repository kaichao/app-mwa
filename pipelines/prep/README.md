# 预处理消息路由模块

以python语言编写

## 流水线结构

### mwa数据下载模块

- 从澳洲aws下载数据，输入为观测数据集的标识（起始时间戳）
- 下载数据的目录名称为数据集时间戳，文件为每秒的24 beam的tar打包文件；

### 目录列表模块（标准模块,list-dir）
- 扫描前一模块的目录，产生该目录下文件名相对路径，并发送消息给后续模块；待该目录下载完成后，产生该目录的二维元数据，发送data-grouping模块

### 解包压缩模块(untar)
- 针对24beam的单时间戳文件，解包为24个dat文件，并用zstd对这24个文件分别压缩，将24个压缩文件名发送给后续模块

### data-grouping-2d模块(标准模块，data-grouping)
- 按垂直分组规则，以30秒/60秒为时间间隔，流式生成打包文件名列表，并发送后续模块

### 打包模块(repack)
- 按打包文件名列表，生成打包文件，打包完成后，删除原始的压缩文件。将打包后文件名相对路径发送给后续模块

### ftp-push模块（标准模块，ftp-push）
- 将打包后文件发送到ftp服务器

